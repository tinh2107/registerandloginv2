<%-- 
    Document   : otp
    Created on : Dec 29, 2022, 2:29:10 PM
    Author     : Admin
--%>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
        <link rel="stylesheet" href="css/forgotPassStyles.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            />
    </head>
    <body>
        <section>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <!-- <form action="ForgotPasswordServlet?action=checkEmailPhone" class="forgot-pass-form" method="post">
                <h2>Forgot Password</h2>
                <i class="fa-solid fa-user-lock"></i>
                <input type="hidden" id="otpvalue" value="${otpvalue}">
                <div class="inputBx">
                    <input type="text" name="otptocheck" readonly 
                           onfocus="this.removeAttribute('readonly');">
                    <i>OTP</i>
                </div>                
                <div class="inputBx">
                    <input type="submit" id="confirm-button" value="Confirm">
                </div>
                <p>
                    Enter your recieved OTP to reset password.
                </p>
                <div class="links">
                    <a href="Login.jsp">Back to Login</a>
                </div>
            </form> -->
            <form action="resetPassSuccess" class="reset-pass-form" style="height:490px;" method="post">
                <!-- forgot password form -->
                <h2>Forgot Password</h2>
                <i class="fa-solid fa-user-lock"></i>
                <input type="hidden" id="otpvalue" value="${otpvalue}">
                <input type="hidden" name="usernameToSetPass" value="${usernameToSetPass}">
                <div class="inputotp">

                    <div class="inputBx">
                        <input type="text" name="otptocheck" readonly 
                               onfocus="this.removeAttribute('readonly');">
                        <i>OTP</i>
                    </div>                
                    <div class="inputBx">
                        <input type="button" class="confirm-button" value="Confirm">
                    </div>
                    <p>
                        Enter your recieved OTP to reset password.
                    </p>
                </div>
                <div id="resetpassword">

                    <div class="inputBx checkPassStrength">
                        <input type="password" name="newpassword" id="myPassword" readonly 
                               onfocus="this.removeAttribute('readonly');">
                        <i>New Password</i>
                        <div class="strengthMeter"></div>
                    </div>
                    <div class="inputBx">
                        <input type="password" name="newpasswordconfirm" readonly 
                               onfocus="this.removeAttribute('readonly');">
                        <i>Confirm new password</i>
                    </div>                 
                    <div class="inputBx">
                        <input type="submit" value="Reset">
                    </div>
                </div>
                <div class="links" style="top: -150px;">
                    <a href="Login.jsp">Back to Login</a>
                </div>
            </form>
        </section>
        <style>
            #resetpassword{
                position:relative;

                transform:scale(0) translateX(-110%);
                transition: 0.5s;
            }

            .show #resetpassword{
                transform: scale(1);
                top: -180px;
            }

            .inputotp{
                margin-top: 10px;
                transform:scale(1);
                transition: 0.5s;
            }

            .show .inputotp{
                transform:scale(0) translateX(110%);
            }
            .inputBx input[type="button"]{
                padding:10px;
                font-weight:600;
                font-size:1.25em;
                letter-spacing: 0.05em;
                transition: .5s ease-in-out;
            }

            .inputBx input[type="button"]:hover{
                background: #45f3ff;
                color: #222;
            }

            .checkPassStrength .strengthMeter{
                position:absolute;
                bottom:0;
                left:0;
                width:100%;
                height:3px;
                background:#222;
            }

            .checkPassStrength .strengthMeter::before{
                content:"";
                position:absolute;
                width:0;
                height:100%;
                transition:0.5s;
            }

            .checkPassStrength.weak .strengthMeter::before{
                width:10%;
                background:#f00;
                filter: drop-shadow(0 0 5px #f00) drop-shadow(0 0 10px #f00) drop-shadow(0 0 20px #f00);
            }

            .checkPassStrength.medium .strengthMeter::before{
                width:66.66%;
                background:#ff0;
                filter: drop-shadow(0 0 5px #ff0) drop-shadow(0 0 10px #ff0) drop-shadow(0 0 20px #ff0);
            }

            .checkPassStrength.strong .strengthMeter::before{
                width:100%;
                background:#0f0;
                filter: drop-shadow(0 0 5px #0f0) drop-shadow(0 0 10px #0f0) drop-shadow(0 0 20px #0f0);
            }

            .checkPassStrength .strengthMeter::after{
                content:'';
                position:absolute;
                top: -45px;
                left:30px;
                color:#fff;
                transition: .5s;
            }

        </style>
        <script>
            var otpvalue = document.getElementById("otpvalue").value;
            var otp = document.getElementsByName("otptocheck")[0];
            const confirmBtn = document.querySelector(".confirm-button");
            const resetpassword = document.querySelector(".reset-pass-form");

            // check if confirm button is clicked
            confirmBtn.addEventListener("click", () => {
                // e.preventDefault();
                if (otp.value == otpvalue) {
                    resetpassword.classList.toggle("show");
                } else {
                    alert("OTP is incorrect");
                }
            });

            function Strength(password) {
                let i = 0;
                if (password.length > 6) {
                    i++;
                }
                if (password.length >= 10) {
                    i++;
                }
                if (/[A-Z]/.test(password)) {
                    i++;
                }
                if (/[0-9]/.test(password)) {
                    i++;
                }
                if (/[A-Za-z0-8]/.test(password)) {
                    i++;
                }
                return i;

            }

            let container = document.querySelector(".checkPassStrength");
            document.addEventListener('keyup', function (e) {
                let password = document.querySelector('#myPassword').value;

                let strength = Strength(password);
                if (strength <= 2) {
                    container.classList.add('weak');
                    container.classList.remove('medium');
                    container.classList.remove('strong');
                } else if (strength >= 2 && strength <= 4) {
                    container.classList.add('medium');
                    container.classList.remove('weak');
                    container.classList.remove('strong');
                } else {
                    container.classList.add('strong');
                    container.classList.remove('weak');
                    container.classList.remove('medium');
                }
                if (password.length == 0) {
                    container.classList.remove('weak');
                    container.classList.remove('medium');
                    container.classList.remove('strong');
                }
            })

            const newPass = document.querySelector('#myPassword');
            const confirmPass = document.querySelector('input[name="newpasswordconfirm"]');
            const resetBtn = document.querySelector('input[type="submit"]');

            resetBtn.addEventListener('click', function (e) {
                if (newPass.value == null || newPass.value == "" ){
                    e.preventDefault();
                    alert("Password cannot be empty");
                }
                if (newPass.value != confirmPass.value) {
                    e.preventDefault();
                    alert("Password does not match");
                }
            })

            


        </script>
    </body>
</html>
